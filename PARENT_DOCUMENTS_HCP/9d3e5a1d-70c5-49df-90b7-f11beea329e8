throw new HttpResponseException( httpResponse.getStatusLine().getStatusCode(),

"Unexpected status returned from " + httpRequest.getMethod() + " (" + httpResponse.getStatusLine().getStatusCode() + ": " + httpResponse.getStatusLine().getReasonPhrase() + ")"); }

/*

Determine whether the object data or annotation is first. */ Boolean cmFirst = new Boolean(httpResponse.getFirstHeader( "X-HCP-CustomMetadataFirst").getValue());

/* * Determine the size of the first part based on whether the object

data or annotation is first. */

// Assume the object data is first.

int firstPartSize = Integer.valueOf(httpResponse.getFirstHeader( "X-HCP-Size").getValue());

// If the annotation, do the math.

if (cmFirst) { // subtract the data size from the content length returned.

firstPartSize = Integer.valueOf(httpResponse.getFirstHeader( "Content-Length").getValue()) - firstPartSize;

}

/* * Split and write the file to disk.

*/

WholeIOOutputStream outputCreator = new WholeIOOutputStream(

https://docs.hitachivantara.com/internal/api/webapp/print/72cda581-a515-4975-93dd-f591140b46a3

743/907

6/25/24, 11:34 AM

Content Platform System Management Help new FileOutputStream(sBaseFileName + ".fromHCP"),

new FileOutputStream(sBaseFileName + ".fromHCP.cm"), cmFirst);

outputCreator.copy(httpResponse.getEntity().getContent(),

firstPartSize);

outputCreator.close(); // Files should be created.

// Clean up after ourselves and release the HTTP connection to the // connection manager. EntityUtils.consume(httpResponse.getEntity());

}

. .

. }

Example: Retrieving partial object data

Hereâ€™s a sample HTTP GET request that retrieves the first 10,000 bytes of an object named status27.txt in the status directory.

Request with curl command line

curl -k -H "Authorization: HCP bXl1c2Vy:3f3c6784e97531774380db177774ac8d" -r 0-9999 "https://finance.europe.hcp.example.com/rest/status/status27.txt" > status27a.txt

Request in Python using PycURL

import pycurl filehandle = open("status27a.txt", 'wb')

curl = pycurl.Curl() curl.setopt(pycurl.HTTPHEADER, ["Authorization: HCP

bXl1c2Vy:3f3c6784e97531774380db177774ac8d"])

curl.setopt(pycurl.RANGE, "0-9999") curl.setopt(pycurl.URL, "https://finance.europe.hcp.example.com \ /rest/status/status27.txt") curl.setopt(pycurl.SSL_VERIFYPEER, 0)

curl.setopt(pycurl.SSL_VERIFYHOST, 0) curl.setopt(pycurl.WRITEFUNCTION, filehandle.write)

curl.perform() print curl.getinfo(pycurl.RESPONSE_CODE)

curl.close() filehandle.close()

Request headers

GET /rest/status/status27.txt HTTP/1.1 Range: bytes=0-9999 Host: finance.europe.hcp.example.com Authorization: HCP bXl1c2Vy:3f3c6784e97531774380db177774ac8d

Response headers

HTTP/1.1 206 Partial Content X-HCP-Time: 1335347627

X-HCP-SoftwareVersion: 7.0.0.16 Content-Type: text/plain

Content-Range: bytes 0-9999/38985 Content-Length: 10000