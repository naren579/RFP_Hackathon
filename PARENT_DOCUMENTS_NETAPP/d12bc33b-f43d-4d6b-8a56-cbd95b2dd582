CSTR

A variable-length array of UTF-8 characters. Characters can be escaped with the following conventions:

Backslash is \\.

Carriage return is \r. • Double quotes is \ʺ.

Line feed (new line) is \n.

Characters can be replaced by their hexadecimal equivalents (in the format \xHH, where HH is the hexadecimal value representing the character). Event-specific data

Each audit message in the audit log records data specific to a system event.

Following the opening [AUDT: container that identifies the message itself, the next set of attributes provide information about the event or action described by the audit message. These attributes are highlighted in the following example:

1324 2018-12-05T08:24:45.921845 [AUDT:*\[RSLT\(FC32\):SUCS\]* \[TIME\(UI64\):11454\]\[SAIP\(IPAD\):"10.224.0.100"\]\[S3AI\(CSTR\):"60025621595611246499"\] \[SACC\(CSTR\):"account"\]\[S3AK\(CSTR\):"SGKH4_Nc8SO1H6w3w0nCOFCGgk__E6dYzKlumRs KJA=="\] \[SUSR\(CSTR\):"urn:sgws:identity::60025621595611246499:root"\] \[SBAI\(CSTR\):"60025621595611246499"\]\[SBAC\(CSTR\):"account"\]\[S3BK\(CSTR\):"bucket"\] \[S3KY\(CSTR\):"object"\]\[CBID\(UI64\):0xCC128B9B9E428347\] \[UUID\(CSTR\):"B975D2CE-E4DA-4D14-8A23- 1CB4B83F2CD8"\]\[CSIZ\(UI64\):30720\][AVER(UI32):10] \[ATIM(UI64):1543998285921845]\[ATYP\(FC32\):SHEA\][ANID(UI32):12281045][AMID(FC32):S3RQ] \[ATID(UI64):15552417629170647261]]

The ATYP element (underlined in the example) identifies which event generated the message. This example message includes the SHEA message code ([ATYP(FC32):SHEA]), indicating it was generated by a successful S3 HEAD request. Common elements in audit messages

All audit messages contain the common elements.

Code

Type

Description

AMID

FC32

Module ID: A four-character identifier of the module ID that generated the message. This indicates the code segment within which the audit message was generated.

ANID

UI32

Node ID: The grid node ID assigned to the service that generated the message. Each service is allocated a unique identifier at the time the StorageGRID system is configured and installed. This ID can’t be changed. ASES

UI64

Audit Session Identifier: In previous releases, this element indicated the time at which the audit system was initialized after the service started up. This time value was measured in microseconds since the operating system epoch (00:00:00 UTC on 1 January, 1970).

Note: This element is obsolete and no longer appears in audit messages. ASQN

UI64 The ATYP element (underlined in the example) identifies which event generated the message. This example message includes the SHEA message code ([ATYP(FC32):SHEA]), indicating it was generated by a successful S3 HEAD request. Common elements in audit messages

All audit messages contain the common elements.

Code

Type

Description

AMID

FC32

Module ID: A four-character identifier of the module ID that generated the message. This indicates the code segment within which the audit message was generated.

ANID

UI32

Node ID: The grid node ID assigned to the service that generated the message. Each service is allocated a unique identifier at the time the StorageGRID system is configured and installed. This ID can’t be changed. ASES

UI64

Audit Session Identifier: In previous releases, this element indicated the time at which the audit system was initialized after the service started up. This time value was measured in microseconds since the operating system epoch (00:00:00 UTC on 1 January, 1970).

Note: This element is obsolete and no longer appears in audit messages. ASQN

UI64

Sequence Count: In previous releases, this counter was incremented for each generated audit message on the grid node (ANID) and reset to zero at service restart.

Note: This element is obsolete and no longer appears in audit messages.

ATID

UI64

Trace ID: An identifier that is shared by the set of messages that were triggered by a single event.

1325

Code

Type

Description ATIM

UI64

Timestamp: The time the event was generated that triggered the audit message, measured in microseconds since the operating system epoch (00:00:00 UTC on 1 January, 1970). Note that most available tools for converting the timestamp to local date and time are based on milliseconds.

Rounding or truncation of the logged timestamp might be required. The human-readable time that appears at the beginning of the audit message in the audit.log file is the ATIM attribute in ISO 8601 format. The date and time are represented as YYYY- MMDDTHH:MM:SS.UUUUUU, where the T is a literal string character indicating the beginning of the time segment of the date. UUUUUU are microseconds. ATYP

FC32

Event Type: A four-character identifier of the event being logged. This governs the "payload" content of the message: the attributes that are included.

AVER

UI32