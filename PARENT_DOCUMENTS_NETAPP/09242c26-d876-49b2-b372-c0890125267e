The search integration service is configured using a set of rules contained within <MetadataNotificationConfiguration> and </MetadataNotificationConfiguration> tags. Each rule specifies the objects that the rule applies to, and the destination where StorageGRID should send those objects' metadata. Related information Understand notifications for buckets

856

Use S3 REST API

Create platform services endpoint Use search integration service

The search integration service is one of the three StorageGRID platform services. You can enable this service to send object metadata to a destination search index whenever an object is created, deleted, or its metadata or tags are updated.

You can configure search integration by using the Tenant Manager to apply custom StorageGRID configuration XML to a bucket.

Because the search integration service causes object metadata to be sent to a destination, its configuration XML is referred to as metadata notification configuration XML. This configuration XML is different than the notification configuration XML used to enable event notifications.

See the instructions for implementing S3 client applications for details about the following custom StorageGRID S3 REST API operations:

DELETE Bucket metadata notification configuration

GET Bucket metadata notification configuration

PUT Bucket metadata notification configuration Related information

Configuration XML for search integration

Object metadata included in metadata notifications

JSON generated by search integration service

Configure search integration service

Use S3 REST API Configuration XML for search integration

The search integration service is configured using a set of rules contained within <MetadataNotificationConfiguration> and </MetadataNotificationConfiguration> tags. Each rule specifies the objects that the rule applies to, and the destination where StorageGRID should send those objects' metadata.

Objects can be filtered on the prefix of the object name. For example, you could send metadata for objects with the prefix images to one destination, and metadata for objects with the prefix videos to another. Configurations that have overlapping prefixes arenâ€™t valid, and are rejected when they are submitted. For example, a configuration that includes one rule for objects with the prefix test and a second rule for objects with the prefix test2 is not allowed. Destinations must be specified using the URN of a StorageGRID endpoint that has been created for the search integration service. These endpoints refer to an index and type defined on an Elasticsearch cluster.

857

<MetadataNotificationConfiguration> <Rule> <ID>Rule-1</ID> <Status>rule-status</Status> <Prefix>key-prefix</Prefix> <Destination> <Urn>arn:aws:es:region:account- ID:domain/mydomain/myindex/mytype</Urn> </Destination> </Rule> <Rule> <ID>Rule-2</ID> ... </Rule> ... </MetadataNotificationConfiguration>

The table describes the elements in the metadata notification configuration XML. Name

Description

MetadataNotificationConfiguration Container tag for rules used to specify the objects and

destination for metadata notifications.

Contains one or more Rule elements.

Rule

Container tag for a rule that identifies the objects whose metadata should be added to a specified index.

Rules with overlapping prefixes are rejected.

Included in the MetadataNotificationConfiguration element. ID

Unique identifier for the rule.

Included in the Rule element.

Status

Status can be 'Enabled' or 'Disabled'. No action is taken for rules that are disabled.

Included in the Rule element.

858

Required

Yes

Yes

No

Yes

Name

Description

Prefix

Objects that match the prefix are affected by the rule, and their metadata is sent to the specified destination.

To match all objects, specify an empty prefix.

Included in the Rule element. Destination

Container tag for the destination of a rule.

Included in the Rule element.

Urn

URN of the destination where object metadata is sent. Must be the URN of a StorageGRID endpoint with the following properties:

es must be the third element.

The URN must end with the index and type where the metadata is stored, in the form domain- name/myindex/mytype.

Endpoints are configured using the Tenant Manager or Tenant Management API. They take the following form:

arn:aws:es:region:account- ID:domain/mydomain/myindex/mytype

urn:mysite:es:::mydomain/myindex/myty pe

The endpoint must be configured before the configuration XML is submitted, or configuration will fail with a 404 error.

URN is included in the Destination element.

Use the sample metadata notification configuration XML to learn how to construct your own XML.

Metadata notification configuration that applies to all objects 858

Required

Yes

Yes

No

Yes

Name

Description

Prefix

Objects that match the prefix are affected by the rule, and their metadata is sent to the specified destination.

To match all objects, specify an empty prefix.