554

View allowed metadata space 553

Allowed metadata space

Each Storage Node’s actual reserved space for metadata is subdivided into the space available for object metadata (the allowed metadata space) and the space required for essential database operations (such as compaction and repair) and future hardware and software upgrades. The allowed metadata space governs overall object capacity.

The following table shows how StorageGRID calculates the allowed metadata space for different Storage Nodes, based on the amount of memory for the node and the actual reserved space for metadata. Amount of memory on Storage Node

< 128 GB

>= 128 GB

Actual reserved space for metadata

<= 4 TB

60% of actual reserved space for metadata, up to a maximum of 1.32 TB

60% of actual reserved space for metadata, up to a maximum of 1.98 TB

> 4 TB

(Actual reserved space for metadata − 1 TB) × 60%, up to a maximum of 1.32 TB

(Actual reserved space for metadata − 1 TB) × 60%, up to a maximum of 3.96 TB

554

View allowed metadata space

Follow these steps to view the allowed metadata space for a Storage Node. Steps

1. From the Grid Manager, select NODES.

2. Select the Storage Node.

3. Select the Storage tab.

4. Position your cursor over the Storage used - object metadata chart and locate the Allowed value.

In the screenshot, the Allowed value is 3.96 TB, which is the maximum value for a Storage Node whose actual reserved space for metadata is more than 4 TB.

The Allowed value corresponds to this Prometheus metric: storagegrid_storage_utilization_metadata_allowed_bytes

Example for allowed metadata space

Suppose you install a StorageGRID system using version 11.6. For this example, assume that each Storage Node has more than 128 GB of RAM and that volume 0 of Storage Node 1 (SN1) is 6 TB. Based on these values:

The system-wide Metadata reserved space is set to 8 TB. (This is the default value for StorageGRID 11.6 or higher when each Storage Node has more than 128 GB RAM.)

The actual reserved space for metadata for SN1 is 6 TB. (The entire volume is reserved because volume 0 is smaller than the Metadata reserved space setting.)

The allowed space for metadata on SN1 is 3 TB, based on the calculation shown in the table for allowed space for metadata: (Actual reserved space for metadata − 1 TB) × 60%, up to a maximum of 3.96 TB.

How Storage Nodes of different sizes affect object capacity As described above, StorageGRID evenly distributes object metadata across the Storage Nodes at each site. For this reason, if a site contains Storage Nodes of different sizes, the smallest node at the site determines the site’s metadata capacity.

555

Consider the following example:

You have a single-site grid containing three Storage Nodes of different sizes.

The Metadata reserved space setting is 4 TB.

The Storage Nodes have the following values for the actual reserved metadata space and the allowed metadata space. Storage Node

Size of volume 0

Actual reserved metadata space

Allowed metadata space

SN1

2.2 TB

2.2 TB

1.32 TB

SN2

5 TB

4 TB

1.98 TB

SN3

6 TB 4 TB

1.98 TB

Because object metadata is evenly distributed across the Storage Nodes at a site, each node in this example can only hold 1.32 TB of metadata. The additional 0.66 TB of allowed metadata space for SN2 and SN3 can’t be used.

Similarly, because StorageGRID maintains all object metadata for a StorageGRID system at each site, the overall metadata capacity of a StorageGRID system is determined by the object metadata capacity of the smallest site.

And because object metadata capacity controls the maximum object count, when one node runs out of metadata capacity, the grid is effectively full.

Related information

To learn how to monitor the object metadata capacity for each Storage Node, see the instructions for Monitoring StorageGRID.

To increase the object metadata capacity for your system, expand a grid by adding new Storage Nodes. Increase Metadata Reserved Space setting

You might be able to increase the Metadata Reserved Space system setting if your Storage Nodes meet specific requirements for RAM and available space.

What you’ll need Size of volume 0

Actual reserved metadata space

Allowed metadata space

SN1

2.2 TB

2.2 TB

1.32 TB

SN2

5 TB

4 TB

1.98 TB

SN3

6 TB 4 TB

1.98 TB

Because object metadata is evenly distributed across the Storage Nodes at a site, each node in this example can only hold 1.32 TB of metadata. The additional 0.66 TB of allowed metadata space for SN2 and SN3 can’t be used.

Similarly, because StorageGRID maintains all object metadata for a StorageGRID system at each site, the overall metadata capacity of a StorageGRID system is determined by the object metadata capacity of the smallest site.

And because object metadata capacity controls the maximum object count, when one node runs out of metadata capacity, the grid is effectively full.

Related information