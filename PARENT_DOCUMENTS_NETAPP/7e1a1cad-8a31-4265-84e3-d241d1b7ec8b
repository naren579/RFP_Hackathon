1. The ILM engine selects a Data Mover service to replicate to the Cloud Storage Pool.

2. The Data Mover service sends the object data to the Cloud Storage Pool.

3. The Data Mover service notifies the ILM engine that the object data has been stored.

4. The ILM engine updates the metadata store with object location metadata. Retrieve data flow

A retrieve operation consists of a defined data flow between the StorageGRID system and the client. The system uses attributes to track the retrieval of the object from a Storage Node or, if necessary, a Cloud Storage Pool or Archive Node.

The Storage Node’s LDR service queries the metadata store for the location of the object data and retrieves it from the source LDR service. Preferentially, retrieval is from a Storage Node. If the object is not available on a Storage Node, the retrieval request is directed to a Cloud Storage Pool or to an Archive Node.

If the only object copy is on AWS Glacier storage or the Azure Archive tier, the client application must issue an S3 RestoreObject request to restore a retrievable copy to the Cloud Storage Pool.

29

1. The LDR service receives a retrieval request from the client application.

2. The LDR service queries the metadata store for the object data location and metadata. 3. LDR service forwards the retrieval request to the source LDR service.

4. The source LDR service returns the object data from the queried LDR service and the system returns the object to the client application.

Delete data flow 3. The Data Mover service notifies the ILM engine that the object data has been stored.

4. The ILM engine updates the metadata store with object location metadata. Retrieve data flow

A retrieve operation consists of a defined data flow between the StorageGRID system and the client. The system uses attributes to track the retrieval of the object from a Storage Node or, if necessary, a Cloud Storage Pool or Archive Node.

The Storage Node’s LDR service queries the metadata store for the location of the object data and retrieves it from the source LDR service. Preferentially, retrieval is from a Storage Node. If the object is not available on a Storage Node, the retrieval request is directed to a Cloud Storage Pool or to an Archive Node.

If the only object copy is on AWS Glacier storage or the Azure Archive tier, the client application must issue an S3 RestoreObject request to restore a retrievable copy to the Cloud Storage Pool.

29

1. The LDR service receives a retrieval request from the client application.

2. The LDR service queries the metadata store for the object data location and metadata. 3. LDR service forwards the retrieval request to the source LDR service.

4. The source LDR service returns the object data from the queried LDR service and the system returns the object to the client application.

Delete data flow

All object copies are removed from the StorageGRID system when a client performs a delete operation or when the object’s lifetime expires, triggering its automatic removal. There is a defined data flow for object deletion. Deletion hierarchy

StorageGRID provides several methods for controlling when objects are retained or deleted. Objects can be deleted by client request or automatically. StorageGRID always prioritizes any S3 Object Lock settings over client delete requests, which are prioritized over S3 bucket lifecycle and ILM placement instructions.

S3 Object Lock: If the global S3 Object Lock setting is enabled for the grid, S3 clients can create buckets with S3 Object Lock enabled and then use the S3 REST API to specify retain-until-date and legal hold settings for each object version added to that bucket. An object version that is under a legal hold can’t be deleted by any method. ◦ Before an object version’s retain-until-date is reached, that version can’t be deleted by any method. ◦ Objects in buckets with S3 Object Lock enabled are retained by ILM "forever". However, after its retain- until-date is reached, an object version can be deleted by a client request or the expiration of the bucket lifecycle.

If S3 clients apply a default retain-until-date to the bucket, they don’t need to specify a retain-until-date

30

for each object.

Client delete request: An S3 or Swift client can issue a delete object request. When a client deletes an object, all copies of the object are removed from the StorageGRID system.

Delete objects in bucket: Tenant Manager users can use this option to permanently remove all copies of the objects and object versions in selected buckets from the StorageGRID system. S3 bucket lifecycle: S3 clients can add a lifecycle configuration to their buckets that specifies an Expiration action. If a bucket lifecycle exists, StorageGRID automatically deletes all copies of an object when the date or number of days specified in the Expiration action are met, unless the client deletes the object first.