However, it might be desirable to create multiple disk volumes of a smaller size, as the TSM server can write to each volume in the disk pool. For example, if the tape size is 250 GB, create 25 disk volumes with a size of 10 GB (10000) each.

The TSM server preallocates space in the directory for the disk volume. This can take some time to complete (more than three hours for a 200 GB disk volume).

Define a domain policy and register a node You need to define a domain policy that uses the TSM management class for the data saved from the Archive Node, and then register a node to use this domain policy.

591

Archive Node processes can leak memory if the client password for the Archive Node in Tivoli Storage Manager (TSM) expires. Ensure that the TSM server is configured so the client username/password for the Archive Node never expires. When registering a node on the TSM server for the use of the Archive Node (or updating an existing node), you must specify the number of mount points that the node can use for write operations by specifying the MAXNUMMP parameter to the REGISTER NODE command. The number of mount points is typically equivalent to the number of tape drive heads allocated to the Archive Node. The number specified for MAXNUMMP on the TSM server must be at least as large as the value set for the ARC > Target > Configuration > Main > Maximum Store Sessions for the Archive Node, which is set to a value of 0 or 1, as concurrent store sessions aren’t supported by the Archive Node. The value of MAXSESSIONS set for the TSM server controls the maximum number of sessions that can be opened to the TSM server by all client applications. The value of MAXSESSIONS specified on the TSM must be at least as large as the value specified for ARC > Target > Configuration > Main > Number of Sessions in the Grid Manager for the Archive Node. The Archive Node concurrently creates at most one session per mount point plus a small number (< 5) of additional sessions.

The TSM node assigned to the Archive Node uses a custom domain policy tsm-domain. The tsm-domain domain policy is a modified version of the "standard" domain policy, configured to write to tape and with the archive destination set to be the StorageGRID system’s storage pool (SGWSDiskPool).

You must log in to the TSM server with administrative privileges and use the dsmadmc tool to create and activate the domain policy.

Create and activate the domain policy You must create a domain policy and then activate it to configure the TSM server to save data sent from the Archive Node.

Steps

1. Create a domain policy.

copy domain standard tsm-domain

2. If you aren’t using an existing management class, enter one of the following:

define policyset tsm-domain standard define mgmtclass tsm-domain standard default

default is the default management class for the deployment.

3. Create a copygroup to the appropriate storage pool. Enter (on one line):

define copygroup tsm-domain standard default type=archive destination=SGWSDiskPool retinit=event retmin=0 retver=0

default is the default Management Class for the Archive Node. The values of retinit, retmin, and retver have been chosen to reflect the retention behavior currently used by the Archive Node

592

Don’t set retinit to retinit=create. Setting retinit=create blocks the Archive Node from deleting content, because retention events are used to remove content from the TSM server. You must log in to the TSM server with administrative privileges and use the dsmadmc tool to create and activate the domain policy.

Create and activate the domain policy You must create a domain policy and then activate it to configure the TSM server to save data sent from the Archive Node.

Steps

1. Create a domain policy.

copy domain standard tsm-domain

2. If you aren’t using an existing management class, enter one of the following:

define policyset tsm-domain standard define mgmtclass tsm-domain standard default

default is the default management class for the deployment.

3. Create a copygroup to the appropriate storage pool. Enter (on one line):

define copygroup tsm-domain standard default type=archive destination=SGWSDiskPool retinit=event retmin=0 retver=0

default is the default Management Class for the Archive Node. The values of retinit, retmin, and retver have been chosen to reflect the retention behavior currently used by the Archive Node

592

Don’t set retinit to retinit=create. Setting retinit=create blocks the Archive Node from deleting content, because retention events are used to remove content from the TSM server.

4. Assign the management class to be the default. assign defmgmtclass tsm-domain standard default

5. Set the new policy set as active.

activate policyset tsm-domain standard

Ignore the "no backup copy group" warning that appears when you enter the activate command.