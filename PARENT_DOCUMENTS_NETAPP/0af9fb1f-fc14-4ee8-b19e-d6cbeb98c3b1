Object metadata included in metadata notifications

JSON generated by search integration service

Configure search integration service

860

Configure the search integration service

The search integration service sends object metadata to a destination search index whenever an object is created, deleted, or its metadata or tags are updated.

Before you begin

Platform services were enabled for your tenant account by a StorageGRID administrator.

You have already created an S3 bucket whose contents you want to index.

The endpoint that you intend to use as a destination for the search integration service already exists, and you have its URN.

You belong to a user group that has the Manage all buckets or Root access permission. These permissions override the permission settings in group or bucket policies when configuring the bucket using the Tenant Manager. About this task

After you configure the search integration service for a source bucket, creating an object or updating an object’s metadata or tags triggers object metadata to be sent to the destination endpoint. If you enable the search integration service for a bucket that already contains objects, metadata notifications aren’t automatically sent for existing objects. You must update these existing objects to ensure that their metadata is added to the destination search index. Steps

1. Use a text editor to create the metadata notification XML required to enable search integration.

See the information about configuration XML for search integration. ◦ When configuring the XML, use the URN of a search integration endpoint as the destination. <MetadataNotificationConfiguration> <Rule> <Status>Enabled</Status> <Prefix></Prefix> <Destination> <Urn>arn:aws:es:us-east- 1:11111111111111:domain/mydomain/myindex/mytype</Urn> </Destination> </Rule> </MetadataNotificationConfiguration>

2. In the Tenant Manager select STORAGE (S3) > Buckets.

3. Select the name of the source bucket.

The bucket details page appears.

4. Select Platform services > Search integration

5. Select the Enable search integration checkbox.

6. Paste the metadata notification configuration into the text box, and select Save changes.

861

Platform services must be enabled for each tenant account by a StorageGRID administrator using the Grid Manager or Management API. Contact your StorageGRID administrator if an error occurs when you save the configuration XML.

7. Verify that the search integration service is configured correctly:

a. Add an object to the source bucket that meets the requirements for triggering a metadata notification as specified in the configuration XML.

In the example shown earlier, all objects added to the bucket trigger a metadata notification.

b. Confirm that a JSON document that contains the object’s metadata and tags was added to the search

index specified in the endpoint.

862

After you finish

As necessary, you can disable search integration for a bucket using either of the following methods:

Select STORAGE (S3) > Buckets and clear the Enable search integration checkbox.

If you are using the S3 API directly, use a DELETE Bucket metadata notification request. See the instructions for implementing S3 client applications.

Related information Understand search integration service

Configuration XML for search integration

Use S3 REST API Create platform services endpoint

JSON generated by search integration service

When you enable the search integration service for a bucket, a JSON document is generated and sent to the destination endpoint each time object metadata or tags are added, updated, or deleted.

This example shows an example of the JSON that could be generated when an object with the key SGWS/Tagging.txt is created in a bucket named test. The test bucket is not versioned, so the versionId tag is empty.

{ "bucket": "test", "key": "SGWS/Tagging.txt", "versionId": "", "accountId": "86928401983529626822", "size": 38, "md5": "3d6c7634a85436eee06d43415012855", "region":"us-east-1", "metadata": { "age": "25" }, "tags": { "color": "yellow" } }

Object metadata included in metadata notifications

The table lists all the fields that are included in the JSON document that is sent to the destination endpoint when search integration is enabled. The document name includes the bucket name, object name, and version ID if present.

863

Type

Item name and description Related information Understand search integration service

Configuration XML for search integration

Use S3 REST API Create platform services endpoint

JSON generated by search integration service

When you enable the search integration service for a bucket, a JSON document is generated and sent to the destination endpoint each time object metadata or tags are added, updated, or deleted.

This example shows an example of the JSON that could be generated when an object with the key SGWS/Tagging.txt is created in a bucket named test. The test bucket is not versioned, so the versionId tag is empty.