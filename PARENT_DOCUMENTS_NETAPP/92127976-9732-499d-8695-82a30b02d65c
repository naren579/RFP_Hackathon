You have the latest backup of the Recovery Package file (sgws-recovery-package-id- revision.zip).

1619

• You have the provisioning passphrase. Steps

1. Open your web browser and navigate to https://primary_admin_node_ip.

2. Click Recover a failed primary Admin Node.

3. Upload the most recent backup of the Recovery Package: a. Click Browse.

b. Locate the most recent Recovery Package file for your StorageGRID system, and click Open.

4. Enter the provisioning passphrase.

5. Click Start Recovery.

The recovery process begins. The Grid Manager might become unavailable for a few minutes as the required services start. When the recovery is complete, the sign in page is displayed.

6. If single sign-on (SSO) is enabled for your StorageGRID system and the relying party trust for the Admin Node you recovered was configured to use the default management interface certificate, update (or delete and recreate) the node’s relying party trust in Active Directory Federation Services (AD FS). Use the new default server certificate that was generated during the Admin Node recovery process. For primary Admin Nodes hosted on a services appliance, you have replaced the appliance and have installed software. See the installation instructions for your appliance.

You have the latest backup of the Recovery Package file (sgws-recovery-package-id- revision.zip).

1619

• You have the provisioning passphrase. Steps

1. Open your web browser and navigate to https://primary_admin_node_ip.

2. Click Recover a failed primary Admin Node.

3. Upload the most recent backup of the Recovery Package: a. Click Browse.

b. Locate the most recent Recovery Package file for your StorageGRID system, and click Open.

4. Enter the provisioning passphrase.

5. Click Start Recovery.

The recovery process begins. The Grid Manager might become unavailable for a few minutes as the required services start. When the recovery is complete, the sign in page is displayed.

6. If single sign-on (SSO) is enabled for your StorageGRID system and the relying party trust for the Admin Node you recovered was configured to use the default management interface certificate, update (or delete and recreate) the node’s relying party trust in Active Directory Federation Services (AD FS). Use the new default server certificate that was generated during the Admin Node recovery process.

To configure a relying party trust, see Configure single sign-on. To access the default server certificate, log in to the command shell of the Admin Node. Go to the /var/local/mgmt- api directory, and select the server.crt file. 7. Determine if you need to apply a hotfix.

a. Sign in to the Grid Manager using a supported web browser.

1620

b. Select NODES.

c. From the list on the left, select the primary Admin Node.

d. On the Overview tab, note the version displayed in the Software Version field.

e. Select any other grid node.

f. On the Overview tab, note the version displayed in the Software Version field.

▪ If the versions displayed in the Software Version fields are the same, you don’t need to apply a hotfix.

▪ If the versions displayed in the Software Version fields are different, you must apply a hotfix to

update the recovered primary Admin Node to the same version.

Restore audit log on recovered primary Admin Node

If you were able to preserve the audit log from the failed primary Admin Node, you can copy it to the primary Admin Node you are recovering.

Before you begin

The recovered Admin Node is installed and running.

You have copied the audit logs to another location after the original Admin Node failed. About this task

If an Admin Node fails, audit logs saved to that Admin Node are potentially lost. It might be possible to preserve data from loss by copying audit logs from the failed Admin Node and then restoring these audit logs to the recovered Admin Node. Depending on the failure, it might not be possible to copy audit logs from the failed Admin Node. In that case, if the deployment has more than one Admin Node, you can recover audit logs from another Admin Node as audit logs are replicated to all Admin Nodes.

If there is only one Admin Node and the audit log can’t be copied from the failed node, the recovered Admin Node starts recording events to the audit log as if the installation is new.

You must recover an Admin Node as soon as possible to restore logging functionality.

By default, audit information is sent to the audit log on Admin Nodes. You can skip these steps if either of the following applies: You configured an external syslog server and audit logs are now being sent to the syslog server instead of to Admin Nodes.

You explicitly specified that audit messages should be saved only on the local nodes that generated them.

See Configure audit messages and log destinations for details.

Steps

1. Log in to the recovered Admin Node: a. Enter the following command: ssh admin@recovery_Admin_Node_IP

b. Enter the password listed in the Passwords.txt file.