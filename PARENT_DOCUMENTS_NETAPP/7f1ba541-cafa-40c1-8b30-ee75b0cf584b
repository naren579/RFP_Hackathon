If this is the second Storage Node failure in less than 15 days after a Storage Node failure or recovery, contact technical support. Rebuilding Cassandra on two or more Storage Nodes within 15 days can result in data loss.

If more than one Storage Node at a site has failed, a site recovery procedure might be required. See How technical support recovers a site.

If this Storage Node is in read-only maintenance mode to allow for the retrieval of objects by another Storage Node with failed storage volumes, recover volumes on the Storage Node with failed storage volumes before recovering this failed Storage Node. See the instructions to recover from storage volume failure where system drive is intact. If ILM rules are configured to store only one replicated copy and the copy exists on a storage volume that has failed, you will not be able to recover the object.

If you encounter a Services: Status - Cassandra (SVST) alarm during recovery, see Recover failed storage volumes and rebuild Cassandra database. After Cassandra is rebuilt, alarms should clear. If alarms don’t clear, contact technical support. Replace the Storage Node

If the system drive has failed, you must first replace the Storage Node.

You must select the node replacement procedure for your platform. The steps to replace a node are the same for all types of grid nodes.

This procedure applies to software-based Storage Nodes only. You must follow a different procedure to recover an appliance Storage Node.

Linux: If you aren’t sure if your system drive has failed, follow the instructions to replace the node to determine which recovery steps are required.

1594

Platform

Procedure VMware

Replace a VMware node

Linux

Replace a Linux node

OpenStack

NetApp-provided virtual machine disk files and scripts for OpenStack are no longer supported for recovery operations. If you need to recover a node running in an OpenStack deployment, download the files for your Linux operating system. Then, follow the procedure for replacing a Linux node. Select Start Recovery to configure Storage Node

After replacing a Storage Node, you must select Start Recovery in the Grid Manager to configure the new node as a replacement for the failed node.

Before you begin

You are signed in to the Grid Manager using a supported web browser.

You have the Maintenance or Root access permission.

You have the provisioning passphrase.

You have deployed and configured the replacement node.

You have the start date of any repair jobs for erasure-coded data.

You have verified that the Storage Node has not been rebuilt within the last 15 days. About this task

If the Storage Node is installed as a container on a Linux host, you must perform this step only if one of these is true:

You had to use the --force flag to import the node, or you issued storagegrid node force- recovery node-name

You had to do a full node reinstall, or you needed to restore /var/local. Steps

1. From the Grid Manager, select MAINTENANCE > Tasks > Recovery.

2. Select the grid node you want to recover in the Pending Nodes list.

Nodes appear in the list after they fail, but you can’t select a node until it has been reinstalled and is ready for recovery.

3. Enter the Provisioning Passphrase.

4. Click Start Recovery.

1595

5. Monitor the progress of the recovery in the Recovering Grid Node table. Before you begin

You are signed in to the Grid Manager using a supported web browser.

You have the Maintenance or Root access permission.

You have the provisioning passphrase.

You have deployed and configured the replacement node.

You have the start date of any repair jobs for erasure-coded data.

You have verified that the Storage Node has not been rebuilt within the last 15 days. About this task

If the Storage Node is installed as a container on a Linux host, you must perform this step only if one of these is true:

You had to use the --force flag to import the node, or you issued storagegrid node force- recovery node-name

You had to do a full node reinstall, or you needed to restore /var/local. Steps

1. From the Grid Manager, select MAINTENANCE > Tasks > Recovery.

2. Select the grid node you want to recover in the Pending Nodes list.

Nodes appear in the list after they fail, but you can’t select a node until it has been reinstalled and is ready for recovery.

3. Enter the Provisioning Passphrase.

4. Click Start Recovery.

1595

5. Monitor the progress of the recovery in the Recovering Grid Node table.

While the recovery procedure is running, you can click Reset to start a new recovery. A dialog box appears, indicating that the node will be left in an indeterminate state if you reset the procedure.

If you want to retry the recovery after resetting the procedure, you must restore the node to a pre-installed state, as follows:

VMware: Delete the deployed virtual grid node. Then, when you are ready to restart the recovery, redeploy the node.