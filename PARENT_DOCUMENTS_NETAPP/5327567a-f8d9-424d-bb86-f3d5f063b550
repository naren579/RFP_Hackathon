1642

If you receive this error, verify that you completed the steps in Deploy new Linux hosts. Use the same names for all host interfaces as were used on the original host.

If you are unable to name the host interfaces to match the node configuration file, you can edit the node configuration file and change the value of the GRID_NETWORK_TARGET, the ADMIN_NETWORK_TARGET, or the CLIENT_NETWORK_TARGET to match an existing host interface. Make sure the host interface provides access to the appropriate physical network port or VLAN, and that the interface does not directly reference a bond or bridge device. You must either configure a VLAN (or other virtual interface) on top of the bond device on the host, or use a bridge and virtual Ethernet (veth) pair.

Fix missing block device errors

The system checks that each recovered node maps to a valid block device special file or a valid softlink to a block device special file. If StorageGRID finds invalid mapping in the /etc/storagegrid/nodes/node- name.conf file, a missing block device error displays.

If you observe an error matching this pattern:

Checking configuration file /etc/storagegrid/nodes/<node-name>.conf for node <node-name>... ERROR: <node-name>: BLOCK_DEVICE_PURPOSE = <path-name> <node-name>: <path-name> does not exist It means that /etc/storagegrid/nodes/node-name.conf maps the block device used by node-name for PURPOSE to the given path-name in the Linux file system, but there is not a valid block device special file, or softlink to a block device special file, at that location.

Verify that you completed the steps in Deploy new Linux hosts. Use the same persistent device names for all block devices as were used on the original host.

If you are unable to restore or re-create the missing block device special file, you can allocate a new block device of the appropriate size and storage category and edit the node configuration file to change the value of BLOCK_DEVICE_PURPOSE to point to the new block device special file.

Determine the appropriate size and storage category using the tables for your Linux operating system:

Storage and performance requirements for Red Hat Enterprise Linux

Storage and performance requirements for Ubuntu or Debian Review the recommendations for configuring host storage before proceeding with the block device replacement:

Configure host storage for Red Hat Enterprise Linux

Configure host storage for Ubuntu or Debian Verify that you completed the steps in Deploy new Linux hosts. Use the same persistent device names for all block devices as were used on the original host.

If you are unable to restore or re-create the missing block device special file, you can allocate a new block device of the appropriate size and storage category and edit the node configuration file to change the value of BLOCK_DEVICE_PURPOSE to point to the new block device special file.

Determine the appropriate size and storage category using the tables for your Linux operating system:

Storage and performance requirements for Red Hat Enterprise Linux

Storage and performance requirements for Ubuntu or Debian Review the recommendations for configuring host storage before proceeding with the block device replacement:

Configure host storage for Red Hat Enterprise Linux

Configure host storage for Ubuntu or Debian

If you must provide a new block storage device for any of the configuration file variables starting with BLOCK_DEVICE_ because the original block device was lost with the failed host, ensure the new block device is unformatted before attempting further recovery procedures. The new block device will be unformatted if you are using shared storage and have created a new volume. If you are unsure, run the following command against any new block storage device special files.

1643

Run the following command only for new block storage devices. Donâ€™t run this command if you believe the block storage still contains valid data for the node being recovered, as any data on the device will be lost. sudo dd if=/dev/zero of=/dev/mapper/my-block-device-name bs=1G count=1

Start StorageGRID host service

To start your StorageGRID nodes, and ensure they restart after a host reboot, you must enable and start the StorageGRID host service.

Steps

1. Run the following commands on each host:

sudo systemctl enable storagegrid sudo systemctl start storagegrid

2. Run the following command to ensure the deployment is proceeding: sudo storagegrid node status node-name

3. If any node returns a status of "Not Running" or "Stopped," run the following command:

sudo storagegrid node start node-name

4. If you have previously enabled and started the StorageGRID host service (or if you are unsure if the service has been enabled and started), also run the following command: sudo systemctl reload-or-restart storagegrid

Recover nodes that fail to start normally